# Gene-Ranked RatGene


A Multi-Strategy Gene Ranking Framework for Genome-Scale Constraint-Based Metabolic Network Design


## Introduction
This study introduces a gene importance rank framework and it can be
directly applicable to a range of MILP-based algorithms for the design of genome-scale constraint-based metabolic network, with the aim of improving computational efficiency.




## Dependencies


+ MATLAB <=2021a

+ [IBM ILOG CPLEX](https://www.ibm.com/docs/en/icos/12.10.0?topic=SSSA5P\_12.10.0/ilog.odms.studio.help/Optimization\_Studio/topics/COS\_home.htm) <=12.10.0

+ [CobraToolBox](https://opencobra.github.io/cobratoolbox/stable/index.html)

+ Python >= 3.10

+ Numpy

+ Scipy


## Step 1: Rank Gene Importance

The `GeRank.py` outputs the results of ranked genes by our method. Run the following in command line.

Grammar:

```
python GeRank.py [--model modelname] [--strategy strategyname]
```

Parameters:

+ `--model` indicates the name of the dataset. It will be automatically downloaded from [BiGG](http://bigg.ucsd.edu/) database. Default is e\_coli\_core.

+ `--strategy` indicates one of the nine strategies name. The result will automatically be saved as a `.txt` file. The value can be `multiplicity`, `frequency`, `logic`, `degree`, `revdegree`, `flux`, `revflux`, `fluxdegree`, `revfluxdegree`, and `all`. Default is `frequency`.


Running Example

The following will run to download `iMM904` dataset to `.\data\` folder and generate all nine strategies. 

```
python GeRank.py --model iMM904 --strategy all
```



## Step 2: Gene-Ranked RatGene

Run the following function in MATLAB.

```
function [fstat,gstat] = GeRank(model,genelist,met_id,max_loop)
```

Inputs:
+ `model` indicates the constraint-based metabolic network model.

+ `genelist` indicates a gene list which can be the top n important genes generated by step 1.

+ `met_id` indicates the target metabolite.

+ `max_loop` indicates the maximum loops for RatGene.


Outputs:

+ `fstat` is a 1*4 array indicates the growth-coupled production rate, the value of $\alpha$, the theoretically maximum production rate, and the runtime.

+ `gstat` indicates the generated gene deletion strategy.

Running Example

The following will generate the gene deletion strategy for growth-coupled production of `3-Dehydroshikimate` in `iMM904` model with selecting two genes `['YKR009C','YKL182W']` by frequency and setting maximum loop `200`. 

```
~,gstat = GeRank(iMM904,['YKR009C','YKL182W'],'3dhsk_c',200)
```

